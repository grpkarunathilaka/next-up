<div class="glass-container" [class.dark-mode]="darkMode()">
  <header class="todo-header">
    <h1>✨ Next Up</h1>
    <!-- <div class="header-actions">
      <button (click)="toggleDarkMode()" class="icon-btn" [title]="darkMode() ? 'Light Mode' : 'Dark Mode'">
        <span class="material-symbols-outlined">{{ darkMode() ? 'light_mode' : 'dark_mode' }}</span>
      </button>
      <button (click)="showShortcuts()" class="icon-btn" title="Keyboard Shortcuts (?)">
        <span class="material-symbols-outlined">keyboard</span>
      </button>
      <button (click)="undo()" [disabled]="!undoService.canUndo()" class="icon-btn" title="Undo (Ctrl+Z)">
        <span class="material-symbols-outlined">undo</span>
      </button>
    </div> -->
  </header>

  <!-- @if (shortcutsVisible()) {
    <div class="shortcuts-modal" (click)="shortcutsVisible.set(false)">
      <div class="shortcuts-content glass-card" (click)="$event.stopPropagation()">
        <h3>⌨️ Keyboard Shortcuts</h3>
        <div class="shortcut-list">
          <div class="shortcut-item">
            <div><kbd>Ctrl</kbd> + <kbd>N</kbd></div>
            <span>New Todo</span>
          </div>
          <div class="shortcut-item">
            <div><kbd>Ctrl</kbd> + <kbd>Z</kbd></div>
            <span>Undo</span>
          </div>
        </div>
        <button (click)="shortcutsVisible.set(false)" class="close-btn">Close</button>
      </div>
    </div>
  } -->

  <!-- <app-todo-stats /> -->

  <div class="input-group">
    <div class="priority-dot" [ngClass]="newTodoPriority"></div>
    <input 
      type="text" 
      [(ngModel)]="newTodoTitle"
      (keyup.enter)="addTodo()"
      placeholder="What needs to be done?"
      [disabled]="isLoading()"
    />
    <select [(ngModel)]="newTodoPriority" class="priority-select-mini">
      <option value="low">Low</option>
      <option value="medium">Med</option>
      <option value="high">High</option>
    </select>
    <button (click)="addTodo()" class="add-btn" [disabled]="!newTodoTitle.trim() || isLoading()">
      <span class="material-symbols-outlined">add</span>
    </button>
  </div>

  <div class="filter-row">
  <div class="search-bar">
    <span class="material-symbols-outlined">search</span>
    <input type="text" [(ngModel)]="searchTerm" placeholder="Search todos...">
  </div>
  <div class="filter-chips">
    @for (filter of filters; track filter) {
      <button 
        (click)="activeFilter.set(filter)"
        [class.active]="activeFilter() === filter"
        class="chip"
      >
        {{ filter }}
      </button>
    }
  </div>
</div>

  @if (error()) {
    <div class="error-message">
      {{ error() }}
      <button (click)="error.set(null)">×</button>
    </div>
  }

  <div 
    class="todo-list"
    cdkDropList
    (cdkDropListDropped)="onDrop($event)"
  >
    @if (isLoading()) {
      <div class="loading-spinner">Working...</div>
    } @else {
      @for (todo of filteredTodos(); track todo.id) {
        <app-todo-item 
          [todo]="todo"
          (toggle)="toggleTodo($event)"
          (delete)="deleteTodo($event)"
          cdkDrag
        />
      } @empty {
        <div class="empty-state">
          <p>{{ getEmptyMessage() }}</p>
        </div>
      }
    }
  </div>

  <footer class="footer">
    <!-- <span>Made with ❤️ using Angular 18 & .NET 9</span>
    <span>Drag to reorder • Press ? for shortcuts</span> -->
  </footer>
</div>